<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>即時監控</title>
<style>
:root{
  --bg: #6c6c6c;
  --card: #ffffff;
  --primary: #002b88;
  --primary-light: #3b82f6;
  --danger: #ef4444;
  --muted: #6b7280;
  --shadow: 0 6px 18px rgba(15,23,42,0.08);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
}

html, body { margin:0; height:100%; background:var(--bg); }
body { display:flex; flex-direction:column; align-items:center; padding:24px; }

.card{
  width:100%;
  max-width:1300px;
  background:var(--card);
  border-radius:0;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  height:90vh;
}

/* 標題 */
.header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding:16px 20px;
  background:var(--primary);
  color:white;
}
.title{ font-size:20px; font-weight:600; }

/* 搜尋列 */
.search-block{
  display:block;
  background:#f9fafb;
  padding:12px 20px;
  border-radius:8px;
  margin:12px 16px 0 16px;
}
.select-row{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  align-items:center;
}
.select-row label{ display:flex; align-items:center; gap:6px; font-size:14px; color:var(--muted);}
.select-row select{ padding:6px 10px; border-radius:8px; border:1px solid #e6e6e6; }

/* 共幾筆資料及上方頁碼獨立區塊 */
.top-info{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin:2px 12px;
  font-size:16px;
  color:var(--muted);
  background:#fff;
  padding:2px 12px;
  border-radius:8px;
}

/* 表格滾動區 */
.list-wrapper{ flex:1; overflow-y:auto; margin:12px 16px 0 16px; }
.list{
  width:100%;
  border-top:1px solid #eee;
  border-bottom:1px solid #eee;
  margin-top:0;
}
.list-head, .list-row{
  display:flex;
  align-items:center;
  gap:12px;
  padding:10px 8px;
  box-sizing:border-box;
  flex-shrink:0;
}
.list-head{
  font-weight:700;
  color:var(--muted);
  background:#f9fafb;
  position:sticky;
  top:0;
  z-index:2;
}
.list-row{ border-bottom:1px solid #f2f2f2; font-size:14px; }
.col-1{ width:50px; text-align:center; flex-shrink:0; }
.col-2{ width:80px; text-align:center; flex-shrink:0; }
.col-3{ width:80px; text-align:center; flex-shrink:0; }
.col-4{ flex:1; text-align:center; }
.col-5{ flex:1; text-align:center; }
.col-6,.col-7,.col-8,.col-9,.col-10,.col-11,.col-12{ width:90px; text-align:center; flex-shrink:0; }
.empty{ padding:28px; text-align:center; color:var(--muted); }

/* 分頁 */
.pagination{ display:flex; gap:4px; flex-wrap:wrap; }
.pagination span{ cursor:pointer; padding:3px 5px; color:var(--primary); font-weight:600; font-size:12px; background:transparent; box-shadow:none; }
.pagination span.current{ font-weight:700; text-decoration:underline; cursor:default; color:#111; }
.pagination span.disabled{ color:#999; cursor:default; }

/* 底部分頁置中 */
.pagination-container{ display:flex; justify-content:center; padding:8px 0; background:#fff; margin:0 16px; border-radius:8px; }
.status-circle{ display:inline-block; width:14px; height:14px; border-radius:50%; margin:auto; }
.status-online{background:#22c55e;}
.status-offline{background:#ef4444;}
</style>
</head>
<body>

<div class="card">
  <div class="header">
    <div class="title">即時監控</div>
  </div>

  <!-- 搜尋列區塊 -->
  <div class="search-block">
    <div class="select-row">
      <label>縣市:
        <select id="citySelect">
          <option value="">-</option>
          <option value="臺北市">臺北市</option>
          <option value="新北市">新北市</option>
        </select>
      </label>
      <label>鄉鎮:
        <select id="townSelect">
          <option value="">-</option>
          <option value="中正區">中正區</option>
          <option value="信義區">信義區</option>
        </select>
      </label>
      <label>每頁筆數:
        <select id="pageSizeSelect">
          <option value="25" selected>25</option>
          <option value="50">50</option>
          <option value="75">75</option>
          <option value="100">100</option>
        </select>
      </label>
    </div>
  </div>

  <!-- 共幾筆資料及上方頁碼 -->
  <div class="top-info">
    <span id="topStats">共 0 筆資料</span>
    <span id="topPagination" class="pagination"></span>
  </div>

  <!-- 表格滾動區 -->
  <div class="list-wrapper">
    <div class="list" id="rowsContainer">
      <div class="list-head">
        <div class="col-1">序號</div>
        <div class="col-2">ID</div>
        <div class="col-3">縣市</div>
        <div class="col-4">鄉鎮</div>
        <div class="col-5">案場名稱</div>
        <div class="col-6">TCP</div>
        <div class="col-7">中保防災</div>
        <div class="col-8">氣象</div>
        <div class="col-9">DIO1</div>
        <div class="col-10">DIO2</div>
        <div class="col-11">DIO3</div>
        <div class="col-12">連線</div>
      </div>
      <div class="empty">目前沒有資料。</div>
    </div>
  </div>

  <!-- 底部分頁 -->
  <div class="pagination-container">
    <span id="bottomPagination" class="pagination"></span>
  </div>
</div>

<script>
// ---------- 假資料 ----------
const rowsContainer = document.getElementById('rowsContainer');
const citySelect = document.getElementById('citySelect');
const townSelect = document.getElementById('townSelect');
const pageSizeSelect = document.getElementById('pageSizeSelect');
const topPagination = document.getElementById('topPagination');
const bottomPagination = document.getElementById('bottomPagination');
const topStats = document.getElementById('topStats');

let data = [];
for(let i=1;i<=120;i++){
  data.push({
    id:'ST'+i,
    city:i%2===0?'臺北市':'新北市',
    town:i%3===0?'中正區':'信義區',
    name:'站台 '+i,
    tcp:Math.random()>0.5?'連線':'斷線',
    cbf:Math.random()>0.5?'正常':'異常',
    weather:Math.random()>0.5?'正常':'異常',
    dio1:Math.random()>0.5?'ON':'OFF',
    dio2:Math.random()>0.5?'ON':'OFF',
    dio3:Math.random()>0.5?'ON':'OFF',
  });
}

let pageSize = parseInt(pageSizeSelect.value,10);
let currentPage = 1;

function statusCircle(value){
  return (value==='連線'||value==='正常'||value==='ON') ? '<span class="status-circle status-online"></span>' : '<span class="status-circle status-offline"></span>';
}

function generatePageNumbers(totalPages, current){
  let pages = [];
  if(totalPages<=6){
    for(let i=1;i<=totalPages;i++) pages.push(i);
  } else {
    if(current<=3){
      pages = [1,2,3,'...',totalPages];
    } else if(current>=totalPages-2){
      pages = [1,'...',totalPages-2,totalPages-1,totalPages];
    } else {
      pages = [1,'...',current,'...',totalPages];
    }
  }
  return pages;
}

function createPageSpan(text,page){
  const span = document.createElement('span');
  span.textContent = text;
  if(page===null) span.classList.add('current');
  else span.addEventListener('click',()=>{ currentPage=page; renderTable(); });
  return span;
}

function renderPagination(totalItems){
  const totalPages = Math.ceil(totalItems/pageSize);
  const pages = generatePageNumbers(totalPages,currentPage);
  topPagination.innerHTML='';
  bottomPagination.innerHTML='';

  // 上方頁碼
  topPagination.appendChild(createPageSpan('第一頁',currentPage>1?1:null));
  pages.forEach(p=>{
    if(p==='...'){
      const span=document.createElement('span'); span.textContent='...'; span.className='disabled'; topPagination.appendChild(span);
    } else { topPagination.appendChild(createPageSpan(p,p===currentPage?null:p)); }
  });
  topPagination.appendChild(createPageSpan('最後一頁',currentPage<totalPages?totalPages:null));

  // 下方頁碼
  bottomPagination.appendChild(createPageSpan('上一頁',currentPage>1?currentPage-1:null));
  pages.forEach(p=>{
    if(p==='...'){
      const span=document.createElement('span'); span.textContent='...'; span.className='disabled'; bottomPagination.appendChild(span);
    } else { bottomPagination.appendChild(createPageSpan(p,p===currentPage?null:p)); }
  });
  bottomPagination.appendChild(createPageSpan('下一頁',currentPage<totalPages?currentPage+1:null));
}

function renderTable(){
  const filterCity = citySelect.value;
  const filterTown = townSelect.value;
  let filtered = data.filter(d=>(!filterCity||d.city===filterCity)&&(!filterTown||d.town===filterTown));
  topStats.textContent=`共 ${filtered.length} 筆資料`;

  const totalPages = Math.ceil(filtered.length/pageSize);
  if(currentPage>totalPages) currentPage=totalPages>0?totalPages:1;

  renderPagination(filtered.length);

  rowsContainer.querySelectorAll('.list-row,.empty').forEach(el=>el.remove());
  if(filtered.length===0){
    const div = document.createElement('div'); div.className='empty'; div.textContent='目前沒有資料。';
    rowsContainer.appendChild(div); return;
  }

  const start = (currentPage-1)*pageSize;
  const end = start+pageSize;
  filtered.slice(start,end).forEach((d,i)=>{
    const row = document.createElement('div'); row.className='list-row';
    row.innerHTML = `
      <div class="col-1">${start+i+1}</div>
      <div class="col-2">${d.id}</div>
      <div class="col-3">${d.city}</div>
      <div class="col-4">${d.town}</div>
      <div class="col-5">${d.name}</div>
      <div class="col-6">${statusCircle(d.tcp)}</div>
      <div class="col-7">${statusCircle(d.cbf)}</div>
      <div class="col-8">${statusCircle(d.weather)}</div>
      <div class="col-9">${statusCircle(d.dio1)}</div>
      <div class="col-10">${statusCircle(d.dio2)}</div>
      <div class="col-11">${statusCircle(d.dio3)}</div>
      <div class="col-12">${statusCircle(d.tcp)}</div>
    `;
    rowsContainer.appendChild(row);
  });
}

citySelect.addEventListener('change',()=>{ currentPage=1; renderTable(); });
townSelect.addEventListener('change',()=>{ currentPage=1; renderTable(); });
pageSizeSelect.addEventListener('change',()=>{ pageSize=parseInt(pageSizeSelect.value,10); currentPage=1; renderTable(); });

renderTable();
</script>
</body>
</html>

