<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>å¸³è™Ÿç®¡ç†</title>
<style>
:root{
  --bg:#6c6c6c; --card:#ffffff; --primary:#002b88; --primary-light:#3b82f6;
  --danger:#ef4444; --muted:#6b7280; --shadow:0 6px 18px rgba(15,23,42,0.08); --radius:12px;
  font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans TC','Microsoft JhengHei',sans-serif;
}
html,body{height:100%;margin:0;background:var(--bg);}
body{padding:24px;display:flex;justify-content:center;}
.card{width:100%;max-width:1300px;background:var(--card);border-radius:0;box-shadow:var(--shadow);overflow:hidden;}
.header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;background:var(--primary);color:#fff;}
.title{font-size:20px;font-weight:600;}
.actions{display:flex;gap:8px;}
.btn{border:0;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:600;font-size:14px;}
.btn-primary{background:var(--primary-light);color:#fff;}
.btn-danger{background:var(--danger);color:#fff;}
.icon-btn{padding:6px 8px;border-radius:8px;border:1px solid rgba(0,0,0,.1);background:#fff;cursor:pointer;}
.search-row{display:flex;align-items:center;gap:10px;padding:12px 20px;background:#f9fafb;}
.search-row label{font-weight:500;color:var(--muted);}
.search-row input[type="text"]{padding:6px 8px;border-radius:6px;border:1px solid #ccc;}
.list{border-top:1px solid #eee;border-bottom:1px solid #eee;}
.list-head,.list-row{display:flex;align-items:center;gap:12px;padding:10px 8px;}
.list-head{background:#f9fafb;font-weight:700;color:var(--muted);}
.list-row{border-bottom:1px solid #f2f2f2;}
.col-1{width:60px;text-align:center;color:var(--muted);}
.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9{flex:1;min-width:100px;text-align:center;}
.empty{padding:28px;text-align:center;color:var(--muted);}
#countText{padding:8px 20px;color:var(--muted);}
.modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,.45);display:flex;align-items:center;justify-content:center;z-index:100;}
.modal{background:#fff;border-radius:var(--radius);max-width:760px;width:94%;max-height:90vh;display:flex;flex-direction:column;box-shadow:var(--shadow);}
.modal-body{padding:18px;overflow-y:auto;}
.modal-header{padding:16px 20px;background:var(--primary);color:#fff;font-size:18px;font-weight:600;}
.modal-footer{padding:12px 18px;background:#f9fafb;display:flex;gap:8px;justify-content:flex-end;}
.form-row{display:flex;align-items:flex-start;gap:10px;margin-bottom:12px;}
.form-row label{width:90px;color:var(--muted);font-weight:500;}
.form-row input[type="text"], .form-row input[type="password"], .form-row select{flex:1;padding:6px 8px;border-radius:6px;border:1px solid #ccc;}
.password-wrapper{position:relative;display:flex;align-items:center;}
.password-wrapper input{flex:1;}
.password-wrapper button{position:absolute;right:6px;background:none;border:none;cursor:pointer;font-size:14px;}
#topBtn{position:fixed;right:20px;bottom:20px;width:42px;height:42px;border-radius:8px;background:var(--primary-light);color:#fff;border:none;cursor:pointer;display:none;z-index:200;}
.add-site-list{margin-top:8px;padding-left:0;}
.add-site-list div{padding:4px 6px;background:#f0f0f0;border-radius:4px;margin-bottom:4px;display:flex;justify-content:space-between;align-items:center;}
.add-site-list div span{cursor:pointer;color:red;font-weight:bold;margin-left:8px;}
</style>
</head>
<body>

<div class="card">
  <div class="header">
    <div class="title">å¸³è™Ÿç®¡ç†</div>
    <div class="actions">
      <button class="btn btn-primary" onclick="openModal()">ï¼‹ æ–°å¢å¸³è™Ÿ</button>
    </div>
  </div>

  <!-- æœå°‹åˆ— -->
  <div class="search-row">
    <label>å¸³è™Ÿï¼š</label><input type="text" id="searchAccount" placeholder="è¼¸å…¥å¸³è™Ÿ" />
    <label>åç¨±ï¼š</label><input type="text" id="searchName" placeholder="è¼¸å…¥åç¨±" />
    <button class="btn btn-primary" onclick="searchAccountFunc()">æœå°‹</button>
  </div>

  <div id="countText">å…± 0 ç­†è³‡æ–™</div>

  <div class="list">
    <div class="list-head">
      <div class="col-1">åºè™Ÿ</div>
      <div class="col-2">å¸³è™Ÿ</div>
      <div class="col-3">åç¨±</div>
      <div class="col-4">ç¾¤çµ„</div>
      <div class="col-5">å•Ÿç”¨</div>
      <div class="col-6">æ¡ˆå ´é—œè¯</div>
      <div class="col-7">ç·¨è¼¯</div>
      <div class="col-8">åˆªé™¤</div>
      <div class="col-9">ç€è¦½</div>
    </div>
    <div id="rowsContainer">
      <div class="empty">ç›®å‰æ²’æœ‰å¸³è™Ÿè³‡æ–™</div>
    </div>
  </div>
</div>

<!-- æ–°å¢/ç·¨è¼¯å¸³è™Ÿ Modal -->
<div id="modal" style="display:none">
  <div class="modal-backdrop" onclick="closeModal(event)">
    <div class="modal" onclick="event.stopPropagation()">
      <div class="modal-header" id="modalTitle">æ–°å¢å¸³è™Ÿ</div>
      <div class="modal-body">
        <div class="form-row"><label>å¸³è™Ÿ</label><input id="accUsername" type="text" placeholder="è¼¸å…¥å¸³è™Ÿ" /></div>
        <div class="form-row password-wrapper"><label>å¯†ç¢¼</label>
          <input id="accPassword" type="password" placeholder="è¼¸å…¥å¯†ç¢¼" />
          <button type="button" onclick="togglePassword()">ğŸ‘</button>
        </div>
        <div class="form-row"><label>åç¨±</label><input id="accName" type="text" placeholder="è¼¸å…¥åç¨±" /></div>
        <div class="form-row"><label>ç¾¤çµ„</label><select id="accGroup"><option value="">è«‹é¸æ“‡ç¾¤çµ„</option></select></div>
        <div class="form-row"><label>å‚™è¨»</label><input id="accNote" type="text" placeholder="è¼¸å…¥å‚™è¨»" /></div>
        <div class="form-row"><label>å•Ÿç”¨</label><select id="accEnable"><option value="Y">å•Ÿç”¨</option><option value="N">åœç”¨</option></select></div>
      </div>
      <div class="modal-footer">
        <button class="btn" onclick="closeModal()">å–æ¶ˆ</button>
        <button class="btn btn-primary" id="confirmBtn" onclick="saveAccount()">ç¢ºèª</button>
      </div>
    </div>
  </div>
</div>

<!-- æ¡ˆå ´é—œè¯ Modal -->
<div id="siteModal" style="display:none">
  <div class="modal-backdrop" onclick="closeSiteModal(event)">
    <div class="modal" onclick="event.stopPropagation()">
      <div class="modal-header" id="siteModalTitle">å¸³è™Ÿæ¡ˆå ´é—œè¯</div>
      <div class="modal-body">
        <div class="form-row"><label>å¸³è™Ÿ</label><input id="siteAcc" type="text" disabled /></div>
        <div class="form-row"><label>åç¨±</label><input id="siteName" type="text" disabled /></div>
        <div class="form-row">
          <label>é—œè¯æ¡ˆå ´</label>
          <select id="siteSelect">
            <option value="">è«‹é¸æ“‡æ¡ˆå ´</option>
            <option value="SiteA">SiteA</option>
            <option value="SiteB">SiteB</option>
            <option value="SiteC">SiteC</option>
          </select>
          <button class="btn btn-primary" onclick="addSite()">åŠ å…¥</button>
        </div>
        <div id="siteList" class="add-site-list"></div>
      </div>
      <div class="modal-footer">
        <button class="btn" onclick="closeSiteModal()">å–æ¶ˆ</button>
        <button class="btn btn-primary" onclick="saveSites()">å„²å­˜</button>
      </div>
    </div>
  </div>
</div>

<button id="topBtn" onclick="scrollToTop()">TOP</button>

<script>
let accounts=[], editingIndex=null, siteIndex=null;

// ================= å¯†ç¢¼åˆ‡æ›çœ¼ç› =================
function togglePassword(){
  const pwd=document.getElementById('accPassword');
  pwd.type = pwd.type==='password'?'text':'password';
}

// ================= å¸³è™Ÿåˆ—è¡¨ =================
function render(){
  const rowsContainer=document.getElementById('rowsContainer');
  rowsContainer.innerHTML='';
  if(accounts.length===0){ rowsContainer.innerHTML='<div class="empty">ç›®å‰æ²’æœ‰å¸³è™Ÿè³‡æ–™</div>'; document.getElementById('countText').textContent='å…± 0 ç­†è³‡æ–™'; return; }
  accounts.forEach((acc,i)=>{
    const row=document.createElement('div'); row.className='list-row';
    row.innerHTML=`<div class="col-1">${i+1}</div>
      <div class="col-2">${acc.username}</div>
      <div class="col-3">${acc.name}</div>
      <div class="col-4">${acc.group}</div>
      <div class="col-5">${acc.enable}</div>
      <div class="col-6"><button class="icon-btn" onclick="openSiteModal(${i})">æ¡ˆå ´é—œè¯</button></div>
      <div class="col-7"><button class="icon-btn" onclick="editAccount(${i})">ç·¨è¼¯</button></div>
      <div class="col-8"><button class="icon-btn" onclick="delAccount(${i})">åˆªé™¤</button></div>
      <div class="col-9"><button class="icon-btn" onclick="viewAccount(${i})">ç€è¦½</button></div>`;
    rowsContainer.appendChild(row);
  });
  document.getElementById('countText').textContent=`å…± ${accounts.length} ç­†è³‡æ–™`;
}

// ================= Modal æ“ä½œ =================
function openModal(){ editingIndex=null; document.getElementById('modalTitle').textContent='æ–°å¢å¸³è™Ÿ';
  ['accUsername','accPassword','accName','accGroup','accNote','accEnable'].forEach(id=>{document.getElementById(id).value=''; document.getElementById(id).disabled=false;});
  document.getElementById('accEnable').value='Y';
  document.getElementById('confirmBtn').style.display='inline-block';
  document.getElementById('modal').style.display='block';
}
function closeModal(e){ if(e && e.target!==e.currentTarget) return; document.getElementById('modal').style.display='none'; }
function saveAccount(){ const u=document.getElementById('accUsername').value.trim(), n=document.getElementById('accName').value.trim();
  if(!u||!n){ alert('å¸³è™Ÿèˆ‡åç¨±ç‚ºå¿…å¡«'); return; }
  const data={username:u,password:document.getElementById('accPassword').value,name:n,group:document.getElementById('accGroup').value,
  note:document.getElementById('accNote').value,enable:document.getElementById('accEnable').value,sites:editingIndex!==null?accounts[editingIndex].sites:[]};
  if(editingIndex!==null) accounts[editingIndex]=data; else accounts.push(data);
  closeModal(); render();
}
function editAccount(i){ editingIndex=i; const acc=accounts[i]; document.getElementById('modalTitle').textContent='ç·¨è¼¯å¸³è™Ÿ';
  ['accUsername','accPassword','accName','accGroup','accNote','accEnable'].forEach(id=>{document.getElementById(id).value=acc[id.replace('acc','').toLowerCase()]; document.getElementById(id).disabled=false;});
  document.getElementById('confirmBtn').style.display='inline-block';
  document.getElementById('modal').style.display='block';
}
function viewAccount(i){ const acc=accounts[i]; document.getElementById('modalTitle').textContent='ç€è¦½å¸³è™Ÿ';
  ['accUsername','accPassword','accName','accGroup','accNote','accEnable'].forEach(id=>{document.getElementById(id).value=acc[id.replace('acc','').toLowerCase()]; document.getElementById(id).disabled=true;});
  document.getElementById('confirmBtn').style.display='none'; document.getElementById('modal').style.display='block';
}
function delAccount(i){ if(confirm('ç¢ºå®šåˆªé™¤æ­¤å¸³è™Ÿï¼Ÿ')){ accounts.splice(i,1); render(); }}

// ================= æ¡ˆå ´é—œè¯ =================
function openSiteModal(i){ siteIndex=i; const acc=accounts[i]; document.getElementById('siteAcc').value=acc.username; document.getElementById('siteName').value=acc.name; renderSiteList(); document.getElementById('siteModal').style.display='block'; }
function closeSiteModal(e){ if(e && e.target!==e.currentTarget) return; document.getElementById('siteModal').style.display='none'; }
function addSite(){ const val=document.getElementById('siteSelect').value; if(!val) return; const acc=accounts[siteIndex]; if(!acc.sites.includes(val)) acc.sites.push(val); renderSiteList(); }
function removeSite(name){ const acc=accounts[siteIndex]; acc.sites=acc.sites.filter(s=>s!==name); renderSiteList(); }
function renderSiteList(){ const acc=accounts[siteIndex]; const container=document.getElementById('siteList'); if(acc.sites.length===0) container.innerHTML='<div class="empty">å°šç„¡é—œè¯æ¡ˆå ´</div>'; else container.innerHTML=acc.sites.map(s=>`<div>${s}<span onclick="removeSite('${s}')">âœ•</span></div>`).join(''); }
function saveSites(){ closeSiteModal(); render(); }

// ================= æœå°‹ =================
function searchAccountFunc(){ const username=document.getElementById('searchAccount').value.trim(), name=document.getElementById('searchName').value.trim();
  const filtered=accounts.filter(a=>(!username||a.username.includes(username))&&(!name||a.name.includes(name)));
  const rowsContainer=document.getElementById('rowsContainer'); rowsContainer.innerHTML='';
  if(filtered.length===0){ rowsContainer.innerHTML='<div class="empty">æŸ¥ç„¡è³‡æ–™</div>'; } else {
    filtered.forEach((acc,i)=>{ const row=document.createElement('div'); row.className='list-row';
      row.innerHTML=`<div class="col-1">${i+1}</div><div class="col-2">${acc.username}</div><div class="col-3">${acc.name}</div>
      <div class="col-4">${acc.group}</div><div class="col-5">${acc.enable}</div><div class="col-6"><button class="icon-btn" onclick="openSiteModal(${i})">æ¡ˆå ´é—œè¯</button></div>
      <div class="col-7"><button class="icon-btn" onclick="editAccount(${i})">ç·¨è¼¯</button></div><div class="col-8"><button class="icon-btn" onclick="delAccount(${i})">åˆªé™¤</button></div>
      <div class="col-9"><button class="icon-btn" onclick="viewAccount(${i})">ç€è¦½</button></div>`; rowsContainer.appendChild(row); });
  }
  document.getElementById('countText').textContent=`å…± ${filtered.length} ç­†è³‡æ–™`;
}

// ================= TOP =================
const topBtn=document.getElementById('topBtn'); window.addEventListener('scroll',()=>{ topBtn.style.display=window.scrollY>120?'block':'none'; });
function scrollToTop(){ window.scrollTo({top:0,behavior:'smooth'}); }

render();
</script>

</body>
</html>
